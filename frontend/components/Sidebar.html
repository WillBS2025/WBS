//<script type="text/jsx">

function Sidebar({ collapsed, onCollapse, handleLogout }) {
  // === Roles (desde localStorage) ===
  const [role, setRole] = React.useState(() => {
    try { return (localStorage.getItem('userRole') || 'admin'); } catch (_) { return 'admin'; }
  });
  const norm = (role || '').toString().trim().toLowerCase();
  const isAdmin = norm === 'admin';
  const isSuperAdmin = norm === 'super_admin';
  // ================================
  // ABRE EL SUBMENÚ SI LA URL ES /inventario
  // ================================
  const defaultOpen = React.useMemo(() => {
    try {
      const p = (window.location.pathname || "");
      if (p.startsWith("/inventario")) return ["inventario"];
      if (p.startsWith("/Empleados") || p.startsWith("/Clientes") || p.startsWith("/Usuarios")) return ["personas"];
      return [];
    } catch (_) {
      return [];
    }
  }, []);

  return (
    /* JSX: AGREGO CLASE wb-sidebar PARA APLICAR TU CSS PERSONALIZADO */
    <Layout.Sider
      className={`wb-sidebar ${collapsed ? "is-collapsed" : ""}`}  // APLICA ESTILO GLOBAL DEL SIDEBAR
      collapsible
      trigger={null}                  // JSX: DESACTIVA TRIGGER AUTOMÁTICO DE ANT DESIGN
      collapsed={collapsed}           // JSX: CONTROL TOTAL DESDE EL PADRE
      // onCollapse={onCollapse}      // JSX: DESACTIVADO PARA EVITAR AUTO-COLLAPSE
      // breakpoint="lg"              // JSX: DESACTIVADO PARA QUE NO SE CIERRE POR RESPONSIVE
      collapsedWidth="0"              // OCULTA COMPLETAMENTE EN COLAPSADO (SIGUE SIENDO CONTROLADO)
      style={{ background: "transparent" }} // USAMOS FONDO DE TU CSS
    >
      {/* LOGO / TITULO - USANDO ESTILO DEL LOGIN */}
      <div className="wb-brand">
      <div className="w-20 h-20 flex items-center justify-center rounded-full border-2 border-[#bfa46f] shadow-md bg-[#111]">
        <span className="text-3xl font-extrabold tracking-wide text-[#bfa46f]">WB</span>
      </div>
        {!collapsed && (
          <div className="wb-title">Wilito BarberShop</div>
        )}
      </div>

      <div className="wb-divider" />

      {/* MENÚ PRINCIPAL */}
      <Menu
        theme="dark"
        mode="inline"
        defaultSelectedKeys={["1"]}
        defaultOpenKeys={defaultOpen}
        style={{ background: "transparent", borderInlineEnd: "none" }}
      >
        <Menu.Item key="1" icon={<icons.HomeOutlined />}>
          <Link to="/">Inicio</Link>
        </Menu.Item>

        {isSuperAdmin && (
        <Menu.Item key="2" icon={<icons.ScissorOutlined />}>
          <Link to="/Servicios">Servicios</Link>
        </Menu.Item>
        )}

        {isSuperAdmin && (
        <Menu.SubMenu key="personas" icon={<icons.TeamOutlined />} title="Personas">
          <Menu.Item key="personas-empleados"><Link to="/Empleados">Empleados</Link></Menu.Item>
          <Menu.Item key="personas-clientes"><Link to="/Clientes">Clientes</Link></Menu.Item>
          <Menu.Item key="personas-usuarios"><Link to="/Usuarios">Usuarios</Link></Menu.Item>
        </Menu.SubMenu>
        )}

        {/* ================================
          INVENTARIO CON SUBMENÚ (2 SUBRAMA)
           ================================ */}
        <Menu.SubMenu
          key="inventario"
          icon={<icons.BarcodeOutlined />} // ICONO DEL PADRE
          title="Inventario"
        >
          {/* SUBOPCIÓN: PRODUCTOS */}
          <Menu.Item key="inventario-productos" icon={<icons.AppstoreOutlined />}>
            <Link to="/inventario/Productos">
              Productos
            </Link>
          </Menu.Item>

          {/* SUBOPCIÓN: SUMINISTROS */}
          <Menu.Item key="inventario-suministros" icon={<icons.ScissorOutlined/>}>
            <Link to="/inventario/suministros">
              Suministros
            </Link>
          </Menu.Item>
        </Menu.SubMenu>

        <Menu.Item key="5" icon={<icons.ShoppingCartOutlined />}>
          <Link to="/Ventas">Ventas</Link>
        </Menu.Item>

        {isSuperAdmin && (
        <Menu.Item key="gastos" icon={<icons.DollarOutlined />}>
          <Link to="/Gastos">Gastos</Link>
        </Menu.Item>
        )}

        {isSuperAdmin && (
        <Menu.Item key="6" icon={<icons.LineChartOutlined />}>
          <Link to="/Reportes">Reportes</Link>
        </Menu.Item>
        )}

        {isSuperAdmin && (
        <Menu.Item key="8" icon={<icons.ShopOutlined />}>
          <Link to="/Sucursales">Sucursales</Link>
        </Menu.Item>
        )}

        <Menu.Item key="7" icon={<icons.LogoutOutlined />} onClick={handleLogout}>
          Cerrar Sesión
        </Menu.Item>
      </Menu>
    </Layout.Sider>
  );
}

//</script>
