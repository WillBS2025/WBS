//<script type="text/jsx">

function Routes() {
    const [isAuthenticated, setIsAuthenticated] = useState(localStorage.getItem('isAuthenticated') === 'true');
    const history = useHistory();
    const [collapsed, setCollapsed] = useState(false); // Estado para el sidebar

    useEffect(() => {
        localStorage.setItem('isAuthenticated', isAuthenticated);
    }, [isAuthenticated]);

    const handleLogin = (success) => {
        setIsAuthenticated(success);
        if (success) {
            history.push("/");
        }
    };

    const handleLogout = () => {
        setIsAuthenticated(false);
        localStorage.removeItem('isAuthenticated');
        try { localStorage.removeItem('userRole'); localStorage.removeItem('userInfo'); } catch (_) {}
        history.push("/login");
    };

    // Función para manejar el colapso del sidebar
    const onCollapse = (collapsed) => {
        setCollapsed(collapsed);
    };

    return (
        <Router>
            {isAuthenticated ? (
                <Layout style={{ minHeight: '100vh' }}>
                    {/* Incluimos el componente Sidebar aquí */}
                    <Sidebar
                        collapsed={collapsed}
                        onCollapse={onCollapse}
                        handleLogout={handleLogout}
                    />

                    <Layout className="site-layout">
                        {/* Puedes añadir un Header superior aquí si lo deseas para mostrar el título, etc. */}
                        <Layout.Header className="site-layout-background" style={{ background: '#fff', padding: '0 20px' }}>
                            <div className="flex justify-between items-center h-full">
                                <h2 className="text-2xl font-bold">Mi Aplicación</h2>
                                {/* Si quisieras un header con info del usuario, aquí iría */}
                            </div>
                        </Layout.Header>
                        <Layout.Content style={{ margin: '0 -20px' }}>
                            <Breadcrumb style={{ margin: '-5px 0' }}>
                                {/* Puedes agregar Breadcrumbs dinámicamente según la ruta */}
                            </Breadcrumb>
                            <div className="site-layout-background" style={{ padding: '10px 10px', minHeight: 360 }}>
                                <Switch>
                                    <Route exact path="/" component={Inicio} />
                                    <Route exact path="/Servicios" component={Servicios} />
                                    <Route exact path="/Empleados" component={Empleados} />
                                    <Route exact path="/Inventario" component={Inventario} />
                                    <Route exact path="/Ventas" component={Ventas} />
                                    <Route exact path="/Reportes" component={Reportes} />
                                    <Route exact path="/Sucursales" component={Sucursales} />
                                    <Route exact path="/Gastos" component={Gastos} />
                                    

                                    {/* Rutas hijas de Inventario */}
                                    <Route exact path="/inventario/productos" component={Productos} />
                                    <Route exact path="/inventario/suministros" component={Suministros} />
                                    <Redirect to="/" />
                                </Switch>
                            </div>
                        </Layout.Content>
                        <Layout.Footer style={{ textAlign: 'center', padding: '12px 8px' }}>
                            SomniumIA ©{new Date().getFullYear()}
                        </Layout.Footer>
                    </Layout>
                </Layout>
            ) : (
                // Muestra solo el componente de Login si no está autenticado
                <Switch>
                    <Route exact path="/login">
                        <Login onLogin={handleLogin} />
                    </Route>
                    <Redirect to="/login" /> {/* Redirige siempre al login si no está autenticado */}
                </Switch>
            )}
        </Router>
    );
}

//</script>